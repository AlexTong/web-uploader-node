//devin87@qq.com
//build:2015/07/15 10:15:28
(function(x,v){var m=Q.def,q=Q.getFirst,t=Q.getLast,n=Q.getNext,w=Q.createEle,r=Q.formatSize,u=Q.Event.add,p=Q.Uploader;p.extend({init:function(){var a=this.ops.view;a&&(a.className+=" "+(this.html5?"html5":"html4"))},draw:function(a){var f=this,c=f.ops,g=c.view;if(g){var b=c.button||{},c=m(b.cancel,"\u53d6\u6d88"),b=m(b.remove,"\u5220\u9664"),l=a.name,d=a.id,h=w("div","u-item",'<div class="fl"><div class="u-name" title="'+l+'">'+l+'</div></div><div class="fr"><div class="fl u-size"></div><div class="fl u-speed">--/s</div><div class="fl u-progress-bar"><div class="u-progress" style="width:1%;"></div></div><div class="fl u-detail">0%</div><div class="fl u-state"></div><div class="fl u-op"><a class="u-op-cancel">'+
c+'</a><a class="u-op-remove">'+b+'</a></div></div><div class="clear"></div>');h.taskId=d;a.box=h;g.appendChild(h);b=t(h.childNodes[1]);c=q(b);b=t(b);u(c,"click",function(){f.cancel(d)});u(b,"click",function(){f.remove(d);g.removeChild(h)});f.update(a)}},update:function(a){if(a&&a.box){var f=a.total||a.size,c=a.loaded,g=a.state,b=q(a.box.childNodes[1]),l=n(b),d=n(l),h=q(d),d=n(d),k=n(d),m=p.getStatusText(g);k&&(k.innerHTML=m||"");if(!(0>f)){k="";if(this.html5&&c!=v&&0<=c){var e;g==p.PROCESSING?(e=
Math.min(100*c/f,100).toFixed(1),"100.0"==e&&(e="99.9")):g==p.COMPLETE&&(e="100");e&&(e+="%",h.style.width=e,d&&(d.innerHTML=e||""));k='<span class="u-loaded">'+r(c)+"</span> / ";a=r(a.avg_speed||a.speed)+"/s";l&&(l.innerHTML=a||"")}k+='<span class="u-total">'+r(f)+"</span>";b&&(b.innerHTML=k||"")}}},over:function(a){a&&a.box&&(a.box.className+=" u-over")}})})(window);
